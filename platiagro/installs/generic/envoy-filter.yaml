# Envoy filter to inject the Host header from seldon orechstrator to logger service.
apiVersion: networking.istio.io/v1alpha3
kind: EnvoyFilter
metadata:
  name: add-host-to-logger
  namespace: anonymous
spec:
  configPatches:
  - applyTo: VIRTUAL_HOST
    match:
      context: SIDECAR_OUTBOUND
      routeConfiguration:
        vhost:
          name: logger.anonymous.svc.cluster.local
          route:
            name: default
    patch:
      operation: MERGE
      value:
        request_headers_to_add:
        - append: true
          header:
            key: Host
            value: logger.anonymous.example.com
  workloadSelector:
    labels:
      seldon.io/model: "true"
